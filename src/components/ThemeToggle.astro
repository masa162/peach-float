---
/* src/components/ThemeToggle.astro */
---

<!-- ãƒœã‚¿ãƒ³æœ¬ä½“ï¼ˆå³ä¸‹å›ºå®šï¼‰ -->
<button
  id="theme-toggle"
  class="fixed bottom-4 right-4 z-50 flex items-center justify-center
         h-12 w-12 rounded-full
         bg-peach-500 text-white shadow-lg
         dark:bg-gray-700"
  aria-label="Toggle dark mode"
>
  <span id="theme-icon" class="text-xl leading-none">ðŸŒ™</span>
</button>

<!-- ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
<script is:inline>
  const root   = document.documentElement;
  const button = document.getElementById('theme-toggle');
  const icon   = document.getElementById('theme-icon');

  /* 1) åˆæœŸãƒ†ãƒ¼ãƒžæ±ºå®š */
  const saved = localStorage.getItem('theme');
  if (saved === 'dark' || (!saved && matchMedia('(prefers-color-scheme: dark)').matches)) {
    root.classList.add('dark');
  }
  icon.textContent = root.classList.contains('dark') ? 'â˜€ï¸Ž' : 'ðŸŒ™';

  /* 2) ã‚¯ãƒªãƒƒã‚¯ã§ãƒˆã‚°ãƒ« */
  button.addEventListener('click', () => {
    const isDark = root.classList.toggle('dark');
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
    icon.textContent = isDark ? 'â˜€ï¸Ž' : 'ðŸŒ™';
  });
</script>
